"0","plot_condition <- function(data, condition) {"
"0","  # Summarize data"
"0","  summary <- data %>% "
"0","    group_by(!!sym(condition), survived) %>% "
"0","    summarize(count = n()) %>% "
"0","    mutate(percentage = count / sum(count) * 100)"
"0","  "
"0","  # Plot"
"0","  plot <- ggplot(summary, aes_string(x = condition, y = ""count"", fill = ""survived"")) + "
"0","    geom_bar(stat = ""identity"", position = ""dodge"") + "
"0","    labs(title = paste(""Count of"", condition, ""against Survival""), y = ""Count"", x = condition, fill = ""Survived"") + "
"0","    geom_text(aes(label = paste0(round(percentage, 1), ""%"")), "
"0","              position = position_dodge(width = 0.9), vjust = -0.5) + "
"0","    theme_minimal()"
"0","  "
"0","  return(plot)"
"0","}"
"0",""
"0","conditions <- c(""hypertension"", ""asthma"", ""cirrhosis"", ""other_cancer"")"
"0","plots <- lapply(conditions, function(cond) plot_condition(data, cond))"
"1","[38;5;232m`summarise()` has grouped output by 'hypertension'. You can override using
the `.groups` argument.[39m
"
"1","[38;5;232m`summarise()` has grouped output by 'asthma'. You can override using the
`.groups` argument.[39m
"
"1","[38;5;232m`summarise()` has grouped output by 'cirrhosis'. You can override using
the `.groups` argument.[39m
"
"1","[38;5;232m`summarise()` has grouped output by 'other_cancer'. You can override using
the `.groups` argument.[39m
"
"0","plots "
"1","[[1]]
"
"1","
"
"1","[[2]]
"
"1","
"
"1","[[3]]
"
"1","
"
"1","[[4]]
"
"1","
"
